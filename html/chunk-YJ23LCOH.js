import{$ as Qt,E as qt,O as Ut,Q as Ht,aa as ye,b as kt,ba as we,c as Nt,ca as Xt,d as Gt,da as Kt,ea as Yt,fa as Zt,ga as ei,i as $t,l as jt,r as zt,u as Jt,ua as ti}from"./chunk-SOTNDHXD.js";import{a as Wt}from"./chunk-OC3YPCET.js";import{A as Dt,C as Pt,D as Rt,E as Vt,G as Ot,I as Bt,K as Lt,c as It,k as vt,n as yt,w as wt,x as Tt,y as Et,z as Mt}from"./chunk-VHOEFGWW.js";import{$ as qe,Ac as ft,B as je,Ba as He,Cb as nt,D as ze,Db as ot,F as Je,Fc as Ct,Gc as ht,Hc as xt,I as he,Ic as St,Jb as rt,Mb as at,Mc as At,Nb as lt,Nc as bt,Pc as Ft,Wb as Ae,Xa as Qe,Xb as st,Yb as ct,aa as Y,ab as Xe,b as ke,c as Ce,db as Ke,ec as be,f as Ne,fc as Fe,gc as Ie,hc as mt,i as Ge,ib as Ye,ic as dt,jb as Ze,jc as pt,k as $e,kb as et,kc as _t,lb as tt,lc as ve,mc as gt,na as Ue,ub as xe,vb as Se,wb as it,zc as ut}from"./chunk-ROIA6DOL.js";import{$b as $,Aa as Pe,Ac as R,Bc as V,Cc as O,Da as Re,Ec as Le,Fc as B,Gc as ee,Jc as We,Kb as f,La as g,Ma as u,Nb as Ve,Ob as Oe,Oc as j,Pb as Be,Qc as z,Rb as p,Ub as Z,Xb as T,Yb as N,_b as G,ac as a,bc as l,cc as C,f as De,gc as M,jc as A,lc as o,qc as ge,rc as ue,sb as c,sc as fe,tb as w,vc as U,wc as d,xc as K,yc as P,zc as H}from"./chunk-R2KEE763.js";import{a as y,b as te,h as W}from"./chunk-WWX6BADO.js";var ii=(()=>{class t{transform(e,i=0,n="FCFA"){if(e==null||e==="")return`0${i>0?","+"0".repeat(i):""}\xA0${n}`;let s=typeof e=="string"?parseFloat(e):e;if(isNaN(s))return`0${i>0?","+"0".repeat(i):""} ${n}`;let[b,_]=s.toFixed(i).split("."),m="",E=0;for(let D=b.length-1;D>=0;D--)m=b[D]+m,E++,E%3===0&&D!==0&&(m="\u202F"+m);let k=i>0?`,${_}`:"";return`${m}${k} ${n}`}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275pipe=Re({name:"formatNumberSuffixe",type:t,pure:!0,standalone:!0})}}return t})();var li=["dt"],si=["mapElement"],ci=()=>[Ce,Ge,xe,Se,he,Ae,be,Fe,dt,Ie,ve,we,ye],mi=()=>({marginTop:"80px"}),di=()=>({width:"75vw"}),pi=()=>({height:"300px"}),ni=()=>[5,10,25,50],_i=()=>({borderRadius:"0.75rem"}),gi=(t,r,e,i)=>({"text-right":!0,"bg-positive":t,"bg-zero":r,"bg-negative":e,"cell-animate":i}),ui=()=>({"font-weight":"bold",color:"green"}),fi=()=>["capital","interet","moratoire","autres_engagements","exigible"],Ci=t=>({"background-color":t}),hi=t=>({"background-color":t,"font-size":"1.3rem","font-bold":"bold",color:"black","border-radius":"5px",padding:"0.5rem","margin-left":"1rem"}),xi=()=>({"min-width":"50rem"}),Si=t=>({"background-color":t,"font-size":"1.2rem","font-weight":"bold",color:"black","border-radius":"5px",padding:"0.5rem",display:"inline-block","text-align":"center","margin-left":"auto","margin-right":"auto"}),Ai=()=>["dateFormat","id","nameOp","speculation","compte","formeJuridique","localite"],bi=t=>({"text-right":t});function Fi(t,r){t&1&&(a(0,"div",13),C(1,"p-progressSpinner",14),l())}function Ii(t,r){t&1&&C(0,"i",15)}function vi(t,r){t&1&&(a(0,"div",16)(1,"b",17),d(2," CREDITS | FILTRAGE "),l()())}function yi(t,r){if(t&1){let e=M();a(0,"p-button",23),A("click",function(){g(e);let n=o(3);return u(n.showDialogAddCredit())}),l()}}function wi(t,r){if(t&1){let e=M();a(0,"label",24),d(1,"Agences"),l(),a(2,"p-multiSelect",25),O("ngModelChange",function(n){g(e);let s=o(3);return V(s.selectedAgenceIds,n)||(s.selectedAgenceIds=n),u(n)}),A("onClear",function(){g(e);let n=o(3);return u(n.onAgencesClear())})("onChange",function(){g(e);let n=o(3);return u(n.onAgencesChange())}),l()}if(t&2){let e=o(3);c(2),p("options",e.agences),R("ngModel",e.selectedAgenceIds),p("showClear",!0)("maxSelectedLabels",e.agences.length)}}function Ti(t,r){if(t&1&&f(0,yi,1,0,"p-button",22)(1,wi,3,4),t&2){let e=o(2);T(e.loginService.UserConnexion.user.role.name==="Agence"?0:-1),c(),T(e.loginService.UserConnexion.user.role.name==="Societe"?1:-1)}}function Ei(t,r){if(t&1){let e=M();a(0,"label",26),d(1,"PRODUIT"),l(),a(2,"p-multiSelect",27),O("ngModelChange",function(n){g(e);let s=o(2);return V(s.selectedProduitBruitIds,n)||(s.selectedProduitBruitIds=n),u(n)}),A("onClear",function(){g(e);let n=o(2);return u(n.onProduitsClear())})("onChange",function(){g(e);let n=o(2);return u(n.onProduitsChange())}),l()}if(t&2){let e=o(2);c(2),p("options",e.produitsBruit),R("ngModel",e.selectedProduitBruitIds),p("showClear",!0)("maxSelectedLabels",e.produitsBruit.length)}}function Mi(t,r){if(t&1){let e=M();a(0,"label",28),d(1,"C.A"),l(),a(2,"p-dropdown",29),O("ngModelChange",function(n){g(e);let s=o(2);return V(s.selectedAnnee,n)||(s.selectedAnnee=n),u(n)}),A("onChange",function(n){g(e);let s=o(2);return u(s.onAnneeChange(n))}),l(),a(3,"p-dropdown",30),O("ngModelChange",function(n){g(e);let s=o(2);return V(s.selectedSaison,n)||(s.selectedSaison=n),u(n)}),A("onChange",function(n){g(e);let s=o(2);return u(s.onSaisonChange(n))}),l()}if(t&2){let e=o(2);c(2),p("options",e.annees),R("ngModel",e.selectedAnnee),c(),p("options",e.saisons),R("ngModel",e.selectedSaison)}}function Di(t,r){t&1&&(a(0,"p-toolbar",18),f(1,Ti,2,2,"ng-template",19)(2,Ei,3,4,"ng-template",20)(3,Mi,4,4,"ng-template",21),l())}function Pi(t,r){t&1&&(a(0,"span",31),C(1,"i",32),l(),a(2,"span",33),d(3,"AJOUTER CREDITS CAMPAGNE"),l())}function Ri(t,r){if(t&1&&(a(0,"div",41)(1,"span"),d(2),l()()),t&2){let e=r.$implicit;c(2),K(e.label)}}function Vi(t,r){if(t&1){let e=M();a(0,"label",26),d(1,"FILIERE"),l(),a(2,"p-dropdown",39),O("ngModelChange",function(n){g(e);let s=o(2);return V(s.selectedVarieteDialog,n)||(s.selectedVarieteDialog=n),u(n)}),A("onChange",function(n){g(e);let s=o(2);return u(s.onSelectGroupVarieteChange(n))}),f(3,Ri,3,1,"ng-template",40),l()}if(t&2){let e=o(2);c(2),p("options",e.selectItemGroupVarietes),R("ngModel",e.selectedVarieteDialog),p("group",!0)}}function Oi(t,r){if(t&1){let e=M();a(0,"div",42)(1,"p-calendar",43),O("ngModelChange",function(n){g(e);let s=o(2);return V(s.selectedDate,n)||(s.selectedDate=n),u(n)}),l()()}if(t&2){let e=o(2);c(),Z(B(5,_i)),R("ngModel",e.selectedDate),p("showIcon",!0)("icon",e.calendarIcon)}}function Bi(t,r){if(t&1){let e=M();a(0,"label",44),d(1,"C.A"),l(),a(2,"p-dropdown",29),O("ngModelChange",function(n){g(e);let s=o(2);return V(s.selectedAnnee,n)||(s.selectedAnnee=n),u(n)}),A("onChange",function(n){g(e);let s=o(2);return u(s.onAnneeChangeDialog(n))}),l(),a(3,"p-dropdown",30),O("ngModelChange",function(n){g(e);let s=o(2);return V(s.selectedSaison,n)||(s.selectedSaison=n),u(n)}),A("onChange",function(n){g(e);let s=o(2);return u(s.onSaisonChangeDialog(n))}),l()}if(t&2){let e=o(2);c(2),p("options",e.annees),R("ngModel",e.selectedAnnee),c(),p("options",e.saisons),R("ngModel",e.selectedSaison)}}function Li(t,r){if(t&1){let e=M();a(0,"div",45)(1,"button",46),A("click",function(){g(e),o();let n=U(6),s=o();return u(s.clear(n))}),d(2," Clear "),l(),a(3,"span",47),C(4,"i",48),a(5,"input",49),A("input",function(n){g(e),o();let s=U(6);return u(s.filterGlobal(n.target.value,"contains"))}),l()()()}}function Wi(t,r){if(t&1&&C(0,"p-columnFilter",51),t&2){let e=o().$implicit;p("field",e.field)}}function ki(t,r){if(t&1&&C(0,"p-sortIcon",52),t&2){let e=o().$implicit;p("field",e.field)}}function Ni(t,r){if(t&1&&(a(0,"th",50),f(1,Wi,1,1,"p-columnFilter",51),d(2),f(3,ki,1,1,"p-sortIcon",52),l()),t&2){let e=r.$implicit;p("pSortableColumn",e.field),c(),T(e.filter?1:-1),c(),P(" ",e.header," "),c(),T(e.sort?3:-1)}}function Gi(t,r){t&1&&d(0," Empty list of ops ")}function $i(t,r){if(t&1&&(a(0,"tr"),G(1,Ni,4,4,"th",50,N,!1,Gi,1,0),l()),t&2){let e=r.$implicit;c(),$(e)}}function ji(t,r){if(t&1){let e=M();a(0,"input",58),O("ngModelChange",function(n){g(e);let s=o(2).$implicit,b=o().$implicit;return V(b[s.field],n)||(b[s.field]=n),u(n)}),l()}if(t&2){let e=o(2).$implicit,i=o().$implicit;R("ngModel",i[e.field])}}function zi(t,r){if(t&1&&(d(0),j(1,"formatNumberSuffixe")),t&2){let e=o(2).$implicit,i=o().$implicit;P(" ",z(1,1,i[e.field],2,"")," ")}}function Ji(t,r){if(t&1&&(a(0,"td",54)(1,"p-cellEditor"),f(2,ji,1,1,"ng-template",56)(3,zi,2,5,"ng-template",57),l()()),t&2){let e=o().$implicit,i=o().$implicit,n=o(2);p("ngClass",We(2,gi,i[e.field]>0,i[e.field]===0,i[e.field]<0,n.animateCell))("pEditableColumn",e.field)}}function qi(t,r){if(t&1&&(a(0,"td",55)(1,"span"),d(2),j(3,"formatNumberSuffixe"),l()()),t&2){let e=o(2).$implicit,i=o(2);c(),Z(B(7,ui)),c(),P(" ",z(3,3,i.getExigible(e),2,"FCFA")," ")}}function Ui(t,r){if(t&1&&(a(0,"td"),d(1),l()),t&2){let e=o().$implicit,i=o().$implicit;c(),K(i[e.field])}}function Hi(t,r){if(t&1&&f(0,Ji,4,7,"td",54)(1,qi,4,8,"td",55)(2,Ui,2,1,"td"),t&2){let e=r.$implicit;T(e.field==="capital"||e.field==="interet"||e.field==="moratoire"||e.field==="autres_engagements"?0:e.field==="exigible"?1:2)}}function Qi(t,r){t&1&&d(0," Empty list of ops ")}function Xi(t,r){if(t&1&&(a(0,"tr",53),G(1,Hi,3,1,null,null,N,!1,Qi,1,0),l()),t&2){let e=r.$implicit,i=r.columns;p("pSelectableRow",e),c(),$(i)}}function Ki(t,r){if(t&1&&(a(0,"td",59),d(1),j(2,"formatNumberSuffixe"),l()),t&2){let e=o(4);c(),P(" ",z(2,1,e.getTotal("capital"),2,"")," ")}}function Yi(t,r){if(t&1&&(a(0,"td",59),d(1),j(2,"formatNumberSuffixe"),l()),t&2){let e=o(4);c(),P(" ",z(2,1,e.getTotal("interet"),2,"")," ")}}function Zi(t,r){if(t&1&&(a(0,"td",59),d(1),j(2,"formatNumberSuffixe"),l()),t&2){let e=o(4);c(),P(" ",z(2,1,e.getTotal("moratoire"),2,"")," ")}}function en(t,r){if(t&1&&(a(0,"td",59)(1,"strong"),d(2),j(3,"formatNumberSuffixe"),l()()),t&2){let e=o(4);c(2),K(z(3,1,e.getTotal("autres_engagements"),2,""))}}function tn(t,r){if(t&1&&(a(0,"td",59)(1,"strong"),d(2),j(3,"formatNumberSuffixe"),l()()),t&2){let e=o(4);c(2),K(z(3,1,e.getTotal("exigible"),2,"FCFA"))}}function nn(t,r){t&1&&C(0,"td")}function on(t,r){if(t&1&&f(0,Ki,3,5,"td",59)(1,Yi,3,5,"td",60)(2,Zi,3,5,"td",60)(3,en,4,5,"td",60)(4,tn,4,5,"td",60)(5,nn,1,0,"td",61),t&2){let e=r.$implicit;T(e.field==="capital"?0:-1),c(),p("ngIf",e.field==="interet"),c(),p("ngIf",e.field==="moratoire"),c(),p("ngIf",e.field==="autres_engagements"),c(),p("ngIf",e.field==="exigible"),c(),p("ngIf",!B(6,fi).includes(e.field))}}function rn(t,r){if(t&1&&(a(0,"tr"),G(1,on,6,7,null,null,N),l()),t&2){let e=r.$implicit;c(),$(e)}}function an(t,r){if(t&1&&(a(0,"div",62),d(1),l()),t&2){o();let e=U(6),i=o();c(),H(" R\xE9sultat(s) : ",i.filteredRows(e,i.opsAddRowsWithFilters)," / ",i.totalRows(i.opsAddRowsWithFilters)," ")}}function ln(t,r){if(t&1&&(a(0,"p-toolbar",18),f(1,Vi,4,3,"ng-template",19)(2,Oi,2,6,"ng-template",20)(3,Bi,4,4,"ng-template",21),l(),a(4,"div",7)(5,"p-table",34,0),f(7,Li,6,0,"ng-template",35),C(8,"br"),f(9,$i,4,1,"ng-template",9)(10,Xi,4,2,"ng-template",36)(11,rn,3,0,"ng-template",12)(12,an,2,2,"ng-template",37),l()(),C(13,"div",38)),t&2){let e=o();c(5),p("columns",e.colsOps)("value",e.opsAddRowsWithFilters)("rows",50)("paginator",!0)("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",B(8,ni))("scrollable",!0)}}function sn(t,r){if(t&1){let e=M();a(0,"div",63)(1,"p-button",64),A("onClick",function(){g(e);let n=o();return u(n.onDialogHideAddCredit())}),l(),a(2,"p-button",65),A("onClick",function(){g(e);let n=o();return u(n.confirmValidation())}),l()()}if(t&2){let e=o();c(2),p("disabled",!e.activeAddCredit)}}function cn(t,r){if(t&1&&(a(0,"span",69),d(1),a(2,"span",70),d(3),l()()),t&2){let e=o(2).$implicit,i=o(2);c(),H(" | Exigibles: ",i.creditSumGroupsAgence[e.id].sumExigiblesFormatString," | Remboursements: ",i.creditSumGroupsAgence[e.id].sumRemboursementsFormatString," | "),c(),p("ngStyle",ee(4,Ci,i.appService.backgroundColorCredit(i.creditSumGroupsAgence[e.id].sumTauxRemboursement))),c(),P(" Taux Remb.: ",i.creditSumGroupsAgence[e.id].sumtauxRemboursementFormatString," ")}}function mn(t,r){if(t&1&&(a(0,"div",16),C(1,"i",67),a(2,"span",68),d(3),f(4,cn,4,6,"span",69),l()()),t&2){let e=o().$implicit,i=o(2);c(3),H("",e.id," - ",e.name," "),c(),T(i.creditSumGroupsAgence[e.id]&&i.creditSumGroupsAgence[e.id].sumExigibles>0?4:-1)}}function dn(t,r){if(t&1&&(a(0,"span",73),d(1),l(),a(2,"span",74),d(3),l()),t&2){let e=o(2).$implicit,i=o(4);c(),H(" | Exigibles: ",i.creditSumGroups[e.pointId].sumExigiblesFormatString," | Remboursements: ",i.creditSumGroups[e.pointId].sumRemboursementsFormatString," | "),c(),p("ngStyle",ee(4,hi,i.appService.backgroundColorCredit(i.creditSumGroups[e.pointId].sumTauxRemboursement))),c(),P(" Taux Remb.: ",i.creditSumGroups[e.pointId].sumtauxRemboursementFormatString," ")}}function pn(t,r){if(t&1&&(a(0,"div",16),C(1,"i",67),a(2,"span",72),d(3),f(4,dn,4,6),l()()),t&2){let e=o().$implicit,i=o(4);c(3),H("",e.pointId," - ",e.point==null?null:e.point.name," "),c(),T(i.creditSumGroups[e.pointId].sumExigibles>0?4:-1)}}function _n(t,r){if(t&1){let e=M();a(0,"div",45)(1,"button",46),A("click",function(){g(e),o();let n=U(2),s=o(6);return u(s.clear(n))}),d(2," Clear "),l(),a(3,"span",47),C(4,"i",48),a(5,"input",76),A("input",function(n){g(e),o();let s=U(2);return u(s.filterGlobal(n.target.value,"contains"))}),l()()()}}function gn(t,r){if(t&1&&C(0,"p-columnFilter",51),t&2){let e=o().$implicit;p("field",e.field)}}function un(t,r){if(t&1&&C(0,"p-sortIcon",52),t&2){let e=o().$implicit;p("field",e.field)}}function fn(t,r){if(t&1&&(a(0,"th",50),f(1,gn,1,1,"p-columnFilter",51),d(2),f(3,un,1,1,"p-sortIcon",52),l()),t&2){let e=r.$implicit;p("pSortableColumn",e.field),c(),T(e.filter?1:-1),c(),P(" ",e.header," "),c(),T(e.sort?3:-1)}}function Cn(t,r){t&1&&d(0," Empty list of credits ")}function hn(t,r){if(t&1&&(a(0,"tr")(1,"th",77),C(2,"i",78),l(),G(3,fn,4,4,"th",50,N,!1,Cn,1,0),a(6,"th",79),d(7," ACTIONS "),l()()),t&2){let e=r.$implicit;c(3),$(e)}}function xn(t,r){if(t&1&&(a(0,"td",83)(1,"span",74),d(2),l()()),t&2){let e=o(2).$implicit,i=o().$implicit,n=o(7);c(),p("ngStyle",ee(2,Si,n.appService.backgroundColorCredit(i[e.field]))),c(),P(" ",i[e.field].toFixed(2)+" %"," ")}}function Sn(t,r){if(t&1&&(a(0,"td",84)(1,"span"),d(2),l()()),t&2){let e=o(2).$implicit,i=o().$implicit;p("ngClass",ee(3,bi,!B(2,Ai).includes(e.field))),c(2),K(i[e.field])}}function An(t,r){if(t&1&&f(0,xn,3,4,"td",83)(1,Sn,3,5,"td",84),t&2){let e=o().$implicit;T(e.field==="tauxRemboursement"?0:1)}}function bn(t,r){t&1&&f(0,An,2,1),t&2&&T(0)}function Fn(t,r){if(t&1){let e=M();a(0,"tr")(1,"td")(2,"p-button",80),A("click",function(){return g(e),u(null)}),l()(),G(3,bn,1,1,null,null,N),a(5,"td")(6,"p-button",81),A("click",function(){return g(e),u(null)}),l()(),a(7,"td")(8,"p-button",82),A("click",function(){return g(e),u(null)}),l()()()}if(t&2){let e=r.$implicit,i=r.columns,n=r.expanded;c(2),p("pRowToggler",e)("icon",n?"pi pi-chevron-down":"pi pi-chevron-right"),c(),$(i)}}function In(t,r){if(t&1&&(a(0,"div",62),d(1),l()),t&2){o();let e=U(2),i=o(2).$implicit,n=o(4);c(),H(" R\xE9sultat(s) : ",n.filteredRows(e,n.creditGroups[i.pointId])," / ",n.totalRows(n.creditGroups[i.pointId])," ")}}function vn(t,r){if(t&1&&(a(0,"div",7)(1,"p-table",75,2),f(3,_n,6,0,"ng-template",35),C(4,"br"),f(5,hn,8,1,"ng-template",9)(6,Fn,9,2,"ng-template",36)(7,In,2,2,"ng-template",37),l()()),t&2){let e=o(2).$implicit,i=o(4);c(),p("filters",i.tableCreditsFilters)("columns",i.colsCreditsAgences)("value",i.creditGroups[e.pointId])("tableStyle",B(11,xi))("loading",i.loading)("rows",50)("paginator",!0)("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",B(12,ni))("scrollable",!0)}}function yn(t,r){if(t&1&&d(0),t&2){let e=o(2).$implicit;P(" LA LISTE DES CREDITS EST VIDE POUR ",e.point==null?null:e.point.name," ")}}function wn(t,r){if(t&1&&(C(0,"div",71,1),f(2,vn,8,13,"div",7)(3,yn,1,1)),t&2){let e=o().$implicit,i=o(4);c(2),T(i.creditGroups[e.pointId].length>0?2:3)}}function Tn(t,r){t&1&&(a(0,"p-accordionTab"),f(1,pn,5,3,"ng-template",9)(2,wn,4,1,"ng-template",10),l())}function En(t,r){t&1&&d(0," LA LISTE DES POINTS DE COLLECTE EST VIDE ")}function Mn(t,r){if(t&1&&(C(0,"div",71,1),a(2,"div",66)(3,"p-accordion",8),G(4,Tn,3,0,"p-accordionTab",null,N,!1,En,1,0),l()()),t&2){let e=o().$implicit,i=o(2);c(4),$(i.filteredPoints(e.id))}}function Dn(t,r){t&1&&(a(0,"p-accordionTab"),f(1,mn,5,3,"ng-template",9)(2,Mn,7,1,"ng-template",10),l())}function Pn(t,r){t&1&&d(0," LA LISTE DES AGENCES EST VIDE ")}function Rn(t,r){if(t&1&&(a(0,"div",66)(1,"p-accordion",8),G(2,Dn,3,0,"p-accordionTab",null,N,!1,Pn,1,0),l()(),C(5,"br")),t&2){let e=o();c(2),$(e.selectedAgences)}}function Vn(t,r){}function On(t,r){t&1&&(a(0,"span"),d(1,"Chargement..."),l())}function Bn(t,r){t&1&&(a(0,"span"),d(1,"Error"),l())}var Te=function(t){return t[t.DebutPage=0]="DebutPage",t[t.FinPage=1]="FinPage",t}(Te||{}),or=(()=>{class t{constructor(e,i,n,s,b,_,m,E,k,D,J,q,L){this.store=e,this.location=i,this.appService=n,this.loginService=s,this.authService=b,this.dialogService=_,this.creditService=m,this.fb=E,this.pointAgenceService=k,this.navigationService=D,this.messageService=J,this.confirmationService=q,this.primengConfig=L,this.colsCredit=[],this.colsOps=[],this.colsCreditCustom=[],this.colsCreditsAgences=[],this.colsRemboursements=[],this.PageNames=Te,this.dialogPageIndex=Te.DebutPage,this.dialogPages=[{label:"Cr\xE9dit"},{label:"Compte d'exploitation"}],this.unsubscribe$=new De,this.submitted=!1,this.loading=!1,this.loadingNavigation=!1,this.progress=50,this.calendarIcon="pi pi-calendar",this.animateCell=!1,this.activeAddCredit=!1,this.selectedDate=null,this.dateAffichee=null,this.annees=[],this.selectedSaisonId=null,this.selectedAnneeId=null,this.varietes=[],this.selectItemGroupVarietes=[],this.produitsBruit=[],this.selectedProduitBruitIds=[],this.campagnes=[],this.saisons=[],this.localites=[],this.formeJuridiques=[],this.societes=[],this.societe={},this.agences=[],this.selectedAgenceIds=[],this.selectedAgences=[],this.creditGroupsAgence={},this.creditSumGroupsAgence={},this.creditSumSociete={id:0,sumCapitals:0,sumCapitalsFormatString:"",sumInterets:0,sumInteretsFormatString:"",sumMoratoires:0,sumMoratoiresFormatString:"",sumAutresEngagements:0,sumAutresEngagementsFormatString:"",sumExigibles:0,sumExigiblesFormatString:"",sumRemboursements:0,sumRemboursementsFormatString:"",sumTauxRemboursement:0,sumtauxRemboursementFormatString:""},this.creditGroups={},this.creditSumGroups={},this.creditSumAgence={sumCapitals:"0 FCFA",sumMoratoires:"0 FCFA",sumInterets:"0 FCFA",sumAutresEngagements:"0 FCFA",sumExigibles:"0 FCFA",sumRemboursements:"0 FCFA"},this.opsWithFilters=[],this.opsAddRowsWithFilters=[],this.op={},this.editedOpsWithFiltersRows=[],this.originalOpsWithFiltersData=[],this.ops=[],this.creditsAgencesWithFilters=[],this.creditAgence={},this.agencesOpsWithFilters=[],this.agenceOp={},this.pointsCollectesFromAgence=[],this.pointFromAgence=void 0,this.pointsCollectesFromSociete=[],this.pointFromSociete={},this.tableCreditsFilters={},this.displayAddCredit=!1,this.varietes=this.loginService.allVarietes.map(F=>y({},F)),this.produitsBruit=this.authService.allProduitsBrut,this.annees=this.loginService.allAnnees.map(F=>y({},F)),this.localites=this.loginService.allLocalites.map(F=>y({},F)),this.formeJuridiques=this.loginService.allFormeJuridiques.map(F=>y({},F)),this.saisons=this.loginService.allSaisons.map(F=>y({},F)),this.selectedSaisonId=this.appService.getLocalselectedCampagneSaisonId(),this.selectedAnneeId=this.appService.getLocalselectedCampagneAnneeId(),this.pointsCollectesFromAgence$=this.store.pipe(Y(wt(this.loginService.UserConnexion.user.userAgences.idAgence))),this.pointsCollectesFromSociete$=this.store.pipe(Y(Tt(parseInt(this.appService.getLocalselectedSocieteId())))),this.agences$=this.store.pipe(Y(vt)),this.agences$.subscribe(F=>{this.agences=F.map(v=>y({},v)),this.agences=this.agences.filter(v=>v.societeId===parseInt(this.appService.getLocalselectedSocieteId())),this.selectedAgenceIds.length===0?this.selectedAgences=this.agences:this.selectedAgences=this.agences.filter(v=>this.selectedAgenceIds.includes(v.id))})}ngOnInit(){return W(this,null,function*(){this.selectedSaison=this.loginService.mySelectedSaison,console.log("this.loginService.mySelectedSaison",this.loginService.mySelectedSaison),localStorage.setItem("selectedSaisonId",this.loginService.mySelectedSaison?.id?.toString()||""),localStorage.setItem("selectedSaisonName",this.loginService.mySelectedSaison?.name?.toString()||""),this.selectedAnnee=this.loginService.mySelectedAnnee,console.log("this.loginService.mySelectedAnnee",this.loginService.mySelectedAnnee),localStorage.setItem("selectedAnneeId",this.loginService.mySelectedAnnee?.id?.toString()??""),localStorage.setItem("selectedAnneeName",this.loginService.mySelectedAnnee?.name?.toString()||""),this.selectedVariete=void 0,localStorage.setItem("selectedVarieteId",this.loginService.mySelectedVariete?.id?.toString()||""),localStorage.setItem("selectedVarieteName",this.loginService.mySelectedVariete?.name?.toString()||""),this.selectedVarieteId=parseInt(this.appService.getLocalselectedVarieteId()),this.colsOps=[{field:"id",header:"ID",sort:!1,filter:!1},{field:"localite",header:"LOCALITE",sort:!0,filter:!0},{field:"formeJuridique",header:"F.J",sort:!0,filter:!0},{field:"name",header:"O.P",sort:!0,filter:!0},{field:"compte",header:"COMPTE",sort:!0,filter:!0},{field:"capital",header:"CAPITAL",sort:!0,filter:!0},{field:"interet",header:"INTERET",sort:!0,filter:!0},{field:"moratoire",header:"MORATOIRE",sort:!0,filter:!0},{field:"autres_engagements",header:"AUTRES",sort:!0,filter:!0},{field:"exigible",header:"EXIGIBLE",sort:!0,filter:!0}],this.colsRemboursements=[{field:"id",header:"ID",sort:!1,filter:!1},{field:"date",header:"DATE",sort:!0,filter:!0},{field:"typeRemboursementName",header:"TYPE",sort:!0,filter:!0},{field:"emballageName",header:"EMBALLAGE",sort:!0,filter:!0},{field:"quantiteFormat",header:"QUANTITE",sort:!0,filter:!0},{field:"puFormat",header:"PU",sort:!0,filter:!0},{field:"valeurFormat",header:"VALEUR",sort:!0,filter:!0}],this.colsCreditsAgences=[{field:"id",header:"ID",sort:!1,filter:!1},{field:"formeJuridique",header:"F.J",sort:!0,filter:!0},{field:"nameOp",header:"NOM",sort:!0,filter:!0},{field:"localite",header:"LOCALITE",sort:!0,filter:!0},{field:"compte",header:"COMPTE",sort:!0,filter:!0},{field:"dateFormat",header:"DATE",sort:!0,filter:!0},{field:"speculation",header:"SEPECULATION",sort:!0,filter:!0},{field:"exigibleFormat",header:"EXIGIBLE",sort:!0,filter:!0},{field:"sumRemboursementsFormat",header:"REMBOUR.",sort:!0,filter:!0},{field:"tauxRemboursement",header:"TAUX",sort:!0,filter:!0}],this.primengConfig.setTranslation({dayNames:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],dayNamesShort:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],dayNamesMin:["Di","Lu","Ma","Me","Je","Ve","Sa"],monthNames:["Janvier","F\xE9vrier","Mars","Avril","Mai","Juin","Juillet","Ao\xFBt","Septembre","Octobre","Novembre","D\xE9cembre"],monthNamesShort:["Jan","F\xE9v","Mar","Avr","Mai","Juin","Juil","Ao\xFB","Sep","Oct","Nov","D\xE9c"],today:"Aujourd'hui",clear:"Effacer",dateFormat:"dd/mm/yy",firstDayOfWeek:1}),this.refreshPage()})}refreshPage(){return W(this,null,function*(){this.loading=!0,yield this.initDispatch(),this.initSubscriptionsProgress()})}initDispatch(){return W(this,null,function*(){let e={opId:[],formeJuridiqueId:[],localiteId:[],societeOpId:[],agenceOpId:[],pointId:[],page:1,limit:1e4};e.societeOpId=this.appService.getLocalselectedSocieteId(),e.agenceOpId=this.appService.getLocalselectedAgenceId(),this.appService.removeNullProperties(e),this.store.dispatch(Ue({filter:y({},e)})),this.opsWithFilters$=this.store.pipe(Y(He));let i={societeId:[],agenceId:[],agenceOpId:[],varieteId:[],produitId:[],anneeId:[],saisonId:[],opId:[],page:1,limit:1e3};i.produitId=JSON.parse(localStorage.getItem("selectedProduitBruitIds")||"[]"),i.societeId?.push(parseInt(this.appService.getLocalselectedSocieteId())),i.anneeId?.push(parseInt(this.appService.getLocalselectedAnneeId())),i.saisonId?.push(parseInt(this.appService.getLocalselectedSaisonId())),this.appService.removeNullProperties(i),this.store.dispatch($t({filter:y({},i)})),this.creditsAgencesWithFilters$=this.store.pipe(Y(zt)),this.store.dispatch(It()),this.store.dispatch(yt()),this.store.dispatch(Jt()),this.store.dispatch(qt()),this.store.dispatch(Ut());let n=this.varietes.find(s=>s.id==parseInt(this.appService.getLocalselectedVarieteId()));n&&this.store.dispatch(Ht({produitId:n.produit?.id??0,anneeId:this.appService.getLocalselectedCampagneAnneeId(),saisonId:this.appService.getLocalselectedCampagneSaisonId()})),yield Promise.resolve()})}initSubscriptions(e){return W(this,null,function*(){let i=this.varietes.filter(_=>_.produit?.familleEmplacement?.id===1),n=new Set(i.map(_=>_.produit?.name).filter(_=>_!==void 0)),s=Array.from(n).map(_=>this.varietes.find(m=>m.produit&&m.produit.name===_)?.produit).filter(Boolean),b=[];this.selectItemGroupVarietes=[],s.forEach(_=>{let m={label:_.name,value:_.id,items:[]};b=i.filter(E=>E.produit?.id===m.value),b.forEach(E=>{m.items.push({label:E.name,value:E})}),this.selectItemGroupVarietes.push(m)}),console.time("Time this"),this.opsWithFiltersSubscription=this.opsWithFilters$.subscribe(_=>{_&&(this.opsWithFilters=_.map(m=>te(y({},m),{compte:m.SocieteOp?.[0]?.compte,numRegistre:m.SocieteOp?.[0]?.numRegistre,ninea:m.SocieteOp?.[0]?.ninea,capital:"",interet:"",moratoire:"",autres_engagements:"",exigible:""})),this.originalOpsWithFiltersData=this.opsWithFilters.map(m=>y({},m)),this.opsAddRowsWithFilters=this.opsWithFilters.map(m=>te(y({},m),{localite:m.localite?.name,formeJuridique:m.formeJuridique?.name,capital:"",interet:"",moratoire:"",autres_engagements:"",exigible:""})))}),this.creditsAgencesWithFiltersSubscription=this.creditsAgencesWithFilters$.subscribe(_=>{_&&(e.length>0&&(_=_.filter(m=>m.variete&&e.includes(m.variete.produitId))),this.creditsAgencesWithFilters=_.map(m=>{let k=new Date(m.date).toLocaleDateString("fr-FR"),D=m.RemboursementAgence.reduce((L,F)=>L+F.valeur,0),J=m.capital+m.interet+m.moratoire+m.autres_engagements,q=D/J;return te(y({},m),{dateFormat:k,compte:m.op?.SocieteOp.filter(L=>L.societeId===parseInt(this.appService.getLocalselectedSocieteId()))[0].compte,formeJuridique:m.op?.formeJuridique.name,localite:m.agenceOp.op.localite.name,variete:m.variete.name,produit:m.variete.produit.name,filiere:m.variete.produit.filiere.name,speculation:m.variete.produit.name+" | "+m.variete.name,capitalFormat:this.formatMontant(m.capital),interetFormat:this.formatMontant(m.interet),moratoireFormat:this.formatMontant(m.moratoire),autres_engagementsFormat:this.formatMontant(m.autres_engagements),sumRemboursementsFormat:this.formatMontant(D),tauxRemboursement:q*100,exigibleFormat:this.formatMontant(J),nameOp:m.op?.name})}))}),this.pointsCollectesFromSocieteSubscription=this.pointsCollectesFromSociete$.subscribe(_=>{if(_){this.pointsCollectesFromSociete=_.map(h=>y({},h)),this.selectedAgences.forEach(h=>{this.pointsCollectesFromAgence=this.pointsCollectesFromSociete.filter(S=>S.agence?.id===h.id),this.pointsCollectesFromAgence.forEach(S=>{let Q=this.creditsAgencesWithFilters.filter(x=>x.agenceOp?.point?.id===S.point?.id);this.creditGroups[S.pointId]=Q;let ie=Q.reduce((x,I)=>x+I.capital,0),ne=Q.reduce((x,I)=>x+I.moratoire,0),oe=Q.reduce((x,I)=>x+I.interet,0),re=Q.reduce((x,I)=>x+I.autres_engagements,0),ae=ie+ne+oe+re,le=this.calculerTotalRemboursement(Q),Ee=le/ae*100||0,oi={id:S.id,sumCapitals:ie,sumCapitalsFormatString:ie.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" FCFA",sumMoratoires:ne,sumMoratoiresFormatString:ne.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" FCFA",sumInterets:oe,sumInteretsFormatString:oe.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" FCFA",sumAutresEngagements:re,sumAutresEngagementsFormatString:re.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" FCFA",sumExigibles:ae,sumExigiblesFormatString:ae.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" FCFA",sumRemboursements:le,sumRemboursementsFormatString:le.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" FCFA",sumTauxRemboursement:Ee,sumtauxRemboursementFormatString:Ee.toFixed(2)+" %"};this.creditSumGroups[S.pointId]=oi;let X=this.creditsAgencesWithFilters.filter(x=>x.agenceId===h.id);this.creditGroupsAgence[h.id]=X;let se=X.reduce((x,I)=>x+I.capital,0),ce=X.reduce((x,I)=>x+I.moratoire,0),me=X.reduce((x,I)=>x+I.interet,0),de=X.reduce((x,I)=>x+I.autres_engagements,0),pe=se+ce+me+de,_e=this.calculerTotalRemboursement(X),Me=_e/pe*100||0,ri={id:h.id,sumCapitals:se,sumCapitalsFormatString:se.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" FCFA",sumMoratoires:ce,sumMoratoiresFormatString:ce.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" FCFA",sumInterets:me,sumInteretsFormatString:me.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" FCFA",sumAutresEngagements:de,sumAutresEngagementsFormatString:de.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" FCFA",sumExigibles:pe,sumExigiblesFormatString:pe.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" FCFA",sumRemboursements:_e,sumRemboursementsFormatString:_e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" FCFA",sumTauxRemboursement:Me,sumtauxRemboursementFormatString:Me.toFixed(2)+" %"};this.creditSumGroupsAgence[h.id]=ri})});let m=Object.values(this.creditSumGroupsAgence);this.selectedAgenceIds.length>0&&(m=Object.values(this.creditSumGroupsAgence).filter(h=>this.selectedAgenceIds.includes(h.id)));let E=m.reduce((h,S)=>h+(S.sumCapitals||0),0),k=m.reduce((h,S)=>h+(S.sumMoratoires||0),0),D=m.reduce((h,S)=>h+(S.sumInterets||0),0),J=m.reduce((h,S)=>h+(S.sumAutresEngagements||0),0),q=m.reduce((h,S)=>h+(S.sumExigibles||0),0),L=m.reduce((h,S)=>h+(S.sumRemboursements||0),0),F=L/q*100||0,v={id:0,sumCapitals:E,sumCapitalsFormatString:E.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" FCFA",sumMoratoires:k,sumMoratoiresFormatString:k.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" FCFA",sumInterets:D,sumInteretsFormatString:D.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" FCFA",sumAutresEngagements:J,sumAutresEngagementsFormatString:J.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" FCFA",sumExigibles:q,sumExigiblesFormatString:q.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" FCFA",sumRemboursements:L,sumRemboursementsFormatString:L.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" FCFA",sumTauxRemboursement:F,sumtauxRemboursementFormatString:F.toFixed(2)+" %"};this.loginService.titreSocieteSumExigibles=v.sumExigiblesFormatString,this.loginService.titreSocieteSumCapital=v.sumCapitalsFormatString,this.loginService.titreSocieteSumMoratoire=v.sumMoratoiresFormatString,this.loginService.titreSocieteSumInteret=v.sumInteretsFormatString,this.loginService.titreSocieteSumAutresEngagements=v.sumAutresEngagementsFormatString,this.loginService.titreSocieteSumRemboursements=v.sumRemboursementsFormatString,this.loginService.titreSocieteSumTauxRemboursementFormat=v.sumtauxRemboursementFormatString,this.loginService.titreSocieteSumTauxRemboursement=v.sumTauxRemboursement}setTimeout(()=>{this.loading=!1},1500)},_=>{console.error(" \u274C \u274C \u274C Error fetching points collectes from agence:",_)}),yield Promise.resolve(),console.timeEnd("Time this")})}executeCustomInitSubscriptions(){return W(this,null,function*(){return new Promise(e=>{console.log("Executing custom code..."),this.initSubscriptions(this.selectedProduitBruitIds),setTimeout(()=>{e()},500)})})}initSubscriptionsProgress(){return W(this,null,function*(){for(;this.progress<100;)this.progress+=10,yield this.executeCustomInitSubscriptions(),yield this.delay(1e3)})}delay(e){return new Promise(i=>setTimeout(i,e))}viderBien(){this.initSubscriptions(this.selectedProduitBruitIds)}formatMontant(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")+" FCFA"}isNumber(e){return typeof e=="number"&&!isNaN(e)}calculerTotalRemboursement(e){return e.reduce((i,n)=>{let s=n.RemboursementAgence?.reduce((b,_)=>b+_.valeur,0);return i+(s??0)},0)}CountRecords(e,i){return(e.filteredValue??i).length}totalRows(e){return e?.length||0}filteredRows(e,i){return e.filteredValue?.length??this.totalRows(i)}getTotalExigibles(e){return e.filteredValue?e.filteredValue?.map(i=>i.exigible)?.reduce((i,n)=>i+n,0)||0:e.value?.map(i=>i.exigible)?.reduce((i,n)=>i+n,0)||0}getTotalRemboursements(e){return e.filteredValue?e.filteredValue?.map(i=>i.remboursementsSum)?.reduce((i,n)=>i+n,0)||0:e.value?.map(i=>i.remboursementsSum)?.reduce((i,n)=>i+n,0)||0}getTauxRemboursements(e){let i=0;return this.getTotalExigibles(e)!==0&&(i=this.getTotalRemboursements(e)/this.getTotalExigibles(e)*100),i}formatDate(e){return new Date(e).toLocaleDateString("fr-FR")}allerSuivant(){this.dialogPageIndex=this.dialogPageIndex+1}allerAvant(){this.dialogPageIndex=this.dialogPageIndex-1}estFormulaireValide(){return null}showDialogRemboursements(){return null}showDialogExploitationS(){return null}showDialogCredit(){return null}clear(e){e.clear()}onAnneeChange(e){return W(this,null,function*(){this.selectedAnnee=e.value,console.log("event.value: "+e.value.id),localStorage.setItem("selectedAnneeId",e.value.id.toString()),localStorage.setItem("selectedAnneeName",e.value.name.toString()),this.selectedAnneeId=e.value.id,this.loginService.mySelectedAnnee=e.value,this.loading=!0,this.onReloadCreditAgence()})}onAnneeChangeDialog(e){return W(this,null,function*(){this.selectedAnnee=e.value,console.log("event.value: "+e.value.id),localStorage.setItem("selectedAnneeId",e.value.id.toString()),localStorage.setItem("selectedAnneeName",e.value.name.toString()),this.selectedAnneeId=e.value.id,this.loginService.mySelectedAnnee=e.value})}onSaisonChange(e){this.selectedSaison=e.value,console.log("event.value: "+e.value),localStorage.setItem("selectedSaisonId",e.value.id.toString()),localStorage.setItem("selectedSaisonName",e.value.name.toString()),this.selectedSaisonId=e.value.id,this.loginService.mySelectedSaison=e.value,this.loading=!0,this.onReloadCreditAgence()}onSaisonChangeDialog(e){this.selectedSaison=e.value,console.log("event.value: "+e.value),localStorage.setItem("selectedSaisonId",e.value.id.toString()),localStorage.setItem("selectedSaisonName",e.value.name.toString()),this.selectedSaisonId=e.value.id,this.loginService.mySelectedSaison=e.value}onAgencesChange(){this.selectedAgenceIds.length===0?this.selectedAgences=this.agences:this.selectedAgences=this.agences.filter(e=>this.selectedAgenceIds.includes(e.id)),this.initSubscriptions(this.selectedProduitBruitIds)}onAgencesClear(){console.log("Aucune agence s\xE9lectionn\xE9e"),this.initSubscriptions(this.selectedProduitBruitIds)}onSelectGroupVarieteChange(e){this.selectedVarieteDialog=e.value,console.log("\u2B50 \u2B50 \u2B50 selectedDate: "+this.selectedDate),console.log("\u2B50 \u2B50 \u2B50 this.selectedVarieteDialog "+this.selectedVarieteDialog),e.value&&this.selectedDate!==null&&(this.activeAddCredit=!0)}onSelectDateChange(e){this.selectedDate=e.value,console.log("\u2B50 \u2B50 \u2B50 selectedDate: "+this.selectedDate),console.log("\u2B50 \u2B50 \u2B50 this.selectedVarieteDialog "+this.selectedVarieteDialog),e.value&&this.selectedVarieteDialog!==null&&(this.activeAddCredit=!0)}onProduitsChange(){localStorage.setItem("selectedProduitBruitIds",JSON.stringify(this.selectedProduitBruitIds)),this.initSubscriptions(this.selectedProduitBruitIds)}onProduitsClear(){console.log("Aucun produit selectionn\xE9e"),this.initSubscriptions(this.selectedProduitBruitIds)}filteredPoints(e){return this.pointsCollectesFromSociete.filter(i=>i.agenceId===e)||[]}onReloadCreditAgence(){this.navigationService.reloadRoute("/credit-agence",()=>{console.log("\u23F3 Affichage du loader..."),this.loading=!0},()=>{console.log("\u2705 Rechargement termin\xE9."),this.loading=!1},{},1500)}showDialogAddCredit(){this.displayAddCredit=!0}onDialogHideAddCredit(){this.displayAddCredit=!1}confirmValidation(){this.confirmationService.confirm({message:"Voulez-vous enregistrer ces cr\xE9dits ?",header:"Confirmation",icon:"pi pi-question-circle",acceptLabel:"Oui",rejectLabel:"Non",accept:()=>this.onDialogValidateAddCredit(),reject:()=>{this.messageService.add({severity:"info",summary:"Annul\xE9",detail:"Enregistrement annul\xE9.",life:2e3})}})}onValueChange(){this.animateCell=!0,setTimeout(()=>{this.animateCell=!1},1e3)}onDialogValidateAddCredit(){this.editedOpsWithFiltersRows=[],this.opsAddRowsWithFilters.forEach((e,i)=>{let n=this.originalOpsWithFiltersData[i];(e.capital!==n.capital&&e.capital>0||e.interet!==n.interet&&e.interet>0||e.moratoire!==n.moratoire&&e.moratoire>0||e.autres_engagements!==n.autres_engagements&&e.autres_engagements>0)&&this.editedOpsWithFiltersRows.push(e)}),this.messageService.add({severity:"success",summary:"Succ\xE8s",detail:this.editedOpsWithFiltersRows.length+" Cr\xE9dit(s) enregistr\xE9(s).",life:3e3}),this.displayAddCredit=!1,this.afficherDate(),console.log(" \u2705 \u2705 \u2705  \u2705 \u2705 \u2705  Agence: ",this.appService.getLocalselectedAgenceId()),console.log(" \u2705 \u2705 \u2705  \u2705 \u2705 \u2705 this.editedOpsWithFiltersRows: ",this.editedOpsWithFiltersRows),console.log(" \u2B50 \u2B50 \u2B50  \u2728 \u2728 \u2728 this.campagne: ",this.selectedAnnee?.id+" - "+this.selectedSaison?.name),this.editedOpsWithFiltersRows.length?(this.loading=!0,this.editedOpsWithFiltersRows.forEach(e=>{let i=e.AgenceOp.filter(s=>s.agenceId===parseInt(this.appService.getLocalselectedAgenceId()))[0],n={id:0,date:this.selectedDate??new Date,capital:parseFloat(e.capital)||0,interet:parseFloat(e.interet)||0,moratoire:parseFloat(e.moratoire)||0,autres_engagements:parseFloat(e.autres_engagements)||0,varieteId:this.selectedVarieteDialog?.id,anneeId:this.selectedAnnee?.id,saisonId:this.selectedSaison?.id,agenceOpId:i.id,agenceId:parseInt(this.appService.getLocalselectedAgenceId()),opId:i.opId};this.store.dispatch(jt({body:n}))}),this.onReloadCreditAgence()):this.onDialogHideAddCredit()}afficherDate(){if(this.selectedDate){let e=this.selectedDate.getDate().toString().padStart(2,"0"),i=(this.selectedDate.getMonth()+1).toString().padStart(2,"0"),n=this.selectedDate.getFullYear();this.dateAffichee=`${e}/${i}/${n}`}else this.dateAffichee="Aucune date s\xE9lectionn\xE9e";console.log("\u2705 \u2705 \u2705  \u2705 \u2705 \u2705 this.dateAffichee: ",this.dateAffichee)}sanitizeAmount(e){return typeof e=="string"&&(e=e.replace(/[^\d.-]/g,"").replace(",",".")),parseFloat(e)||0}getExigible(e){return this.sanitizeAmount(e.capital)+this.sanitizeAmount(e.interet)+this.sanitizeAmount(e.moratoire)+this.sanitizeAmount(e.autres_engagements)}getTotal(e){return this.opsAddRowsWithFilters.reduce((i,n)=>e==="exigible"?i+this.sanitizeAmount(n.capital)+this.sanitizeAmount(n.interet)+this.sanitizeAmount(n.moratoire)+this.sanitizeAmount(n.autres_engagements):i+this.sanitizeAmount(n[e]),0)}allowOnlyNumbers(e){let i=e.charCode;i!==0&&i!==46&&(i<48||i>57)&&e.preventDefault()}static{this.\u0275fac=function(i){return new(i||t)(w(qe),w(ke),w(Ft),w(Vt),w(ti),w(kt),w(Zt),w(Ze),w(ei),w(Wt),w(ze),w(je),w(Je))}}static{this.\u0275cmp=Pe({type:t,selectors:[["app-credit-agence"]],viewQuery:function(i,n){if(i&1&&(ge(li,5),ge(si,5)),i&2){let s;ue(s=fe())&&(n.dt=s.first),ue(s=fe())&&(n.mapElement=s.first)}},standalone:!0,features:[Le],decls:20,vars:14,consts:[["myTabClients",""],["mapElement",""],["myTabCredits",""],[2e3,null],["class","overlay",4,"ngIf"],["styleClass","custom-confirm-dialog"],["pTemplate","icon"],[1,"card"],[1,"w-full"],["pTemplate","header"],["pTemplate","content"],["header","Header","appendTo","body",3,"visibleChange","resizable","modal","maximizable","visible","contentStyle"],["pTemplate","footer"],[1,"overlay"],["strokeWidth","5","styleClass","custom-spinner"],[1,"pi","pi-question-circle","animated-icon"],[1,"flex","align-items-center"],[1,"vertical-align-middle","credits-filtrage-title"],["styleClass","mb-4 gap-2"],["pTemplate","left"],["pTemplate","center"],["pTemplate","right"],["icon","pi pi-plus","label","Cr\xE9dits"],["icon","pi pi-plus","label","Cr\xE9dits",3,"click"],["for","agence-dropdown",1,"text-lg","w-24"],["optionLabel","name","optionValue","id","display","chip","placeholder","Select Agences","selectedItemsLabel","{0} items selected",1,"flex-1","border","border-gray-100","rounded-md","shadow-sm","focus:ring","focus:ring-blue-100",3,"ngModelChange","onClear","onChange","options","ngModel","showClear","maxSelectedLabels"],["for","variete-dropdown",1,"text-lg","w-24"],["optionLabel","name","optionValue","id","display","chip","placeholder","Select Produits","selectedItemsLabel","{0} items selected",1,"flex-1","border","border-gray-100","rounded-md","shadow-sm","focus:ring","focus:ring-blue-100",3,"ngModelChange","onClear","onChange","options","ngModel","showClear","maxSelectedLabels"],["for","annee-dropdown",1,"text-lg"],["optionLabel","name","placeholder","CHOISIR: ANNEE",1,"custom-dropdown","min-w-[80px]","max-w-[90px]","w-full",3,"ngModelChange","onChange","options","ngModel"],["optionLabel","description","placeholder","CHOISIR: SAISON",1,"custom-dropdown","min-w-[100px]","max-w-[180px]","w-full",3,"ngModelChange","onChange","options","ngModel"],[1,"p-inputgroup-addon"],[1,"pi","pi-file-edit","icon-file-edit"],[1,"text-xl","font-bold"],["dataKey","id","sortMode","single","rowExpandMode","single","scrollHeight","400px","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"columns","value","rows","paginator","rowHover","showCurrentPageReport","rowsPerPageOptions","scrollable"],["pTemplate","caption"],["pTemplate","body"],["pTemplate","summary"],[1,"p-grid","p-fluid"],["placeholder","-- Vari\xE9t\xE9 --",1,"custom-dropdown","min-w-[80px]","max-w-[120px]","w-full",3,"ngModelChange","onChange","options","ngModel","group"],["pTemplate","group"],[1,"flex","items-center"],[1,"p-inputgroup"],["inputId","dateCredit","placeholder","Date de cr\xE9dit","dateFormat","dd/mm/yy","panelStyleClass","calendar-fun-panel","inputStyleClass","calendar-fun-input","onselect","onSelectDateChange($event)",1,"w-full","text-sm","rounded-xl",3,"ngModelChange","ngModel","showIcon","icon"],["for","campagne-dropdown",1,"text-lg","w-24"],[1,"flex"],["type","button","pButton","","label","Clear","icon","pi pi-filter-slash","title","Clear filters",1,"p-button-outlined",3,"click"],[1,"p-input-icon-left","ml-auto"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search keyword",3,"input"],[2,"background-color","aqua",3,"pSortableColumn"],["type","text","display","menu",1,"ml-auto",3,"field"],[3,"field"],[3,"pSelectableRow"],[2,"vertical-align","middle","padding-right","0.5rem",3,"ngClass","pEditableColumn"],[1,"text-right",2,"text-align","right"],["pTemplate","input"],["pTemplate","output"],["type","text","inputmode","decimal","pattern","^\\d+(\\.\\d{1,2})?$","title","Saisir uniquement un nombre","pInputText","",1,"text-right","input-align-right",3,"ngModelChange","ngModel"],[1,"text-right"],["class","text-right",4,"ngIf"],[4,"ngIf"],[1,"p-d-flex","p-ai-center","p-jc-between"],[1,"flex","justify-content-between","align-items-center","w-full"],["label","Fermer","icon","pi pi-times",1,"p-button-secondary",3,"onClick"],["label","Enregistrer","icon","pi pi-check",1,"p-button-success",3,"onClick","disabled"],[1,"card","flex","justify-content-center"],[1,"pi","pi-folder-open","mr-2","icon-folder-brown"],[1,"vertical-align-middle","credit-agence-header"],[1,"credit-agence-exigibles"],[1,"credit-agence-taux-remb",3,"ngStyle"],["id","mapElement"],[1,"vertical-align-middle","span-point-header"],[1,"credit-exigibles-info"],[3,"ngStyle"],["styleClass","p-datatable-sm","dataKey","id","sortMode","single","rowExpandMode","single","scrollHeight","600px","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"filters","columns","value","tableStyle","loading","rows","paginator","rowHover","showCurrentPageReport","rowsPerPageOptions","scrollable"],["pInputText","","type","text","placeholder","Search",3,"input"],[2,"width","3rem","background-color","aqua"],[1,"pi","pi-eye-slash"],["colspan","2",2,"text-align","center","vertical-align","middle","background-color","aqua"],["pRipple","",1,"p-button-text","p-button-rounded","p-button-plain",3,"click","pRowToggler","icon"],["pRipple","","icon","pi pi-eye ",1,"p-button-rounded","p-button-info","p-mr-2",3,"click"],["pRipple","","icon","pi pi-delete-left",1,"p-button-rounded","p-button-danger","p-mr-2",3,"click"],[2,"text-align","center"],[3,"ngClass"]],template:function(i,n){i&1&&(f(0,Fi,2,0,"div",4),C(1,"p-toast"),a(2,"p-confirmDialog",5),f(3,Ii,1,0,"ng-template",6),l(),a(4,"div",7)(5,"p-accordion",8)(6,"p-accordionTab"),f(7,vi,3,0,"ng-template",9)(8,Di,4,0,"ng-template",10),l()()(),C(9,"br"),a(10,"p-dialog",11),O("visibleChange",function(b){return V(n.displayAddCredit,b)||(n.displayAddCredit=b),b}),f(11,Pi,4,0,"ng-template",9)(12,ln,14,9,"ng-template",10)(13,sn,3,1,"ng-template",12),l(),f(14,Rn,6,1)(15,Vn,0,0)(16,On,2,0)(17,Bn,2,0),Oe(18,14,ci,15,16,17,3,null,Ve)),i&2&&(p("ngIf",n.loading),c(),Z(B(11,mi)),c(9),Z(B(12,di)),p("resizable",!1)("modal",!0)("maximizable",!0),R("visible",n.displayAddCredit),p("contentStyle",B(13,pi)),c(8),Be(n.loading))},dependencies:[$e,Ce,Ne,Mt,Et,Dt,it,xe,Se,he,ft,ut,Gt,Bt,Nt,et,Qe,Xe,Ye,Ke,tt,Ot,ht,Ct,st,Ae,lt,at,gt,be,Fe,mt,pt,_t,Ie,ve,Qt,Kt,Xt,we,ye,Lt,Yt,ot,nt,ct,rt,St,xt,Rt,Pt,bt,At,ii],styles:[".center[_ngcontent-%COMP%]{text-align:center}.left[_ngcontent-%COMP%]{text-align:left}.right[_ngcontent-%COMP%]{text-align:right}.spinner-container[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:9999}.spinner[_ngcontent-%COMP%]{color:#007bff}.center-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:.5vh}.progress-container[_ngcontent-%COMP%]{position:relative}.percentage[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:1.2em;color:#000}.custom-table[_ngcontent-%COMP%]{border-collapse:collapse;width:100%}.custom-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .custom-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:8px;text-align:left}.custom-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f2f2f2}.ui-grid-row[_ngcontent-%COMP%]{position:relative;z-index:1}.ui-grid-col-2[_ngcontent-%COMP%], .ui-grid-col-6[_ngcontent-%COMP%], .ui-grid-col-4[_ngcontent-%COMP%]{position:relative;z-index:2}hr[_ngcontent-%COMP%]{box-sizing:content-box;overflow:visible;background:transparent;height:1px;padding:0;margin:1em 0;background-color:#00f;border:0 none}.custom-dialog-header[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;font-size:20px;padding:16px;border-radius:8px 8px 0 0}.progress-bar-container[_ngcontent-%COMP%]{width:100%;margin:0;padding:0}.custom-progress-bar[_ngcontent-%COMP%]   .p-progressbar-value[_ngcontent-%COMP%]{background-color:#4caf50!important}.custom-progress-bar[_ngcontent-%COMP%]   .p-progressbar-label[_ngcontent-%COMP%]{color:#fff!important;font-weight:700;font-size:14px}.custom-dropdownx[_ngcontent-%COMP%]{background-color:#f7fafc;border:1px solid #d1d5db;border-radius:.375rem;font-size:.875rem;color:#4a5568;padding:.25rem .5rem;outline:none;box-shadow:0 0 0 2px #4299e1;border-color:#4299e1}.text-end[_ngcontent-%COMP%]{text-align:right}  .custom-spinner{width:80px!important;height:80px!important;display:block!important;margin:auto}.overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100vw;height:100vh;display:flex;align-items:center;justify-content:center;background:#fff9;z-index:9999}.bg-positive[_ngcontent-%COMP%]{background-color:#e8f5e9;color:#2e7d32}.bg-negative[_ngcontent-%COMP%]{background-color:#ffebee;color:#c62828}.bg-zero[_ngcontent-%COMP%]{background-color:#f4f4f4;color:#6c757d}.text-right[_ngcontent-%COMP%]{text-align:right;font-variant-numeric:tabular-nums;font-family:Segoe UI,Tahoma,sans-serif}.calendar-fun-input[_ngcontent-%COMP%]{background-color:#fff0f9!important;color:#6b21a8!important;border:2px solid #f472b6!important;border-radius:.75rem!important;padding:.5rem 1rem!important;font-weight:500;transition:all .3s ease}.calendar-fun-input[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 0 3px #a78bfa;border-color:#a78bfa!important}.calendar-fun-panel[_ngcontent-%COMP%]{background-color:#f0f9ff!important;border:2px solid #c084fc!important;border-radius:.75rem!important;color:#4c1d95;font-size:.875rem}"]})}}return t})();export{or as CreditAgenceComponent,Te as PageNames};
