import{k as re}from"./chunk-GDHOLRM5.js";import{a as Me,b as xe,c as N}from"./chunk-42BUWWKI.js";import{$ as ee,Aa as ne,Ac as we,Ba as oe,Ca as le,D as K,Fc as ve,Gc as ye,Hc as be,I as z,Ic as Te,J as Z,Mc as Ie,N as m,Nb as pe,Nc as De,O as d,Pc as Ee,Wb as ce,Xb as me,aa as v,ca as A,da as te,e as Q,ec as de,f as J,fc as ue,g as U,gc as fe,h as X,ic as he,lc as Ce,mc as _e,na as ie,ub as se,uc as ge,wb as ae,zc as Se}from"./chunk-ROIA6DOL.js";import{Aa as B,Ac as Y,Bc as H,Cc as q,Ec as G,Fc as x,Kb as h,La as u,Ma as f,Rb as a,Ub as I,ac as l,bc as r,cc as C,gc as b,jc as _,lc as p,oc as W,qc as R,rc as V,sb as c,sc as M,tb as S,vc as D,wc as w,xc as j,yc as $}from"./chunk-R2KEE763.js";import{a as y,b as P,g as Ve}from"./chunk-WWX6BADO.js";var T="[Clients]",$e=m(`${T} Get Single Client`,d()),nt=m(`${$e.type} Success`,d()),Ae=m(`${T} Get All Clients`),ot=m(`${Ae.type} Success`,d()),E=m(`${T} Create Client`,d()),lt=m(`${E.type} Success`,d()),O=m(`${T} Update Client`,d()),rt=m(`${O.type} Success`,d()),k=m(`${T} Delete Client`,d()),st=m(`${k.type} Success`,d());var Oe=te("client"),Fe=A(Oe,t=>t.clients),Re=A(Oe,t=>t.isLoading);var L=Ve(Me());var ke=["dt"],Le=["mapElement"],Pe=()=>({marginTop:"80px"}),Be=()=>[5,10,25,50],We=()=>({width:"35vw"}),je=()=>({overflow:"visible"}),Ye=()=>({"960px":"75vw","640px":"100vw"}),He=()=>({width:"450px"});function qe(t,s){if(t&1){let e=b();l(0,"button",13),_("click",function(){u(e);let n=p();return f(n.openNew())}),r()}if(t&2){let e=p();a("disabled",e.disableAdd)}}function Ge(t,s){if(t&1){let e=b();l(0,"button",14),_("click",function(n){u(e);let o=p();return f(o.getValue(n))}),r()}}function Qe(t,s){if(t&1){let e=b();l(0,"div",15)(1,"button",16),_("click",function(){u(e);let n=p(),o=D(8);return f(n.clear(o))}),w(2," Clear "),r(),l(3,"span",17),C(4,"i",18),l(5,"input",19),_("input",function(n){u(e),p();let o=D(8);return f(o.filterGlobal(n.target.value,"contains"))}),r()()()}}function Je(t,s){if(t&1&&C(0,"p-columnFilter",26),t&2){let e=p().$implicit;a("field",e.field)}}function Ue(t,s){if(t&1&&C(0,"p-sortIcon",27),t&2){let e=p().$implicit;a("field",e.field)}}function Xe(t,s){if(t&1&&(l(0,"th",23),h(1,Je,1,1,"p-columnFilter",24),w(2),h(3,Ue,1,1,"p-sortIcon",25),r()),t&2){let e=s.$implicit;a("pSortableColumn",e.field),c(),a("ngIf",e.filter===!0),c(),$(" ",e.header," "),c(),a("ngIf",e.sort===!0)}}function Ke(t,s){if(t&1&&(l(0,"tr")(1,"th",20)(2,"i"),w(3,"CREDITS"),r()(),h(4,Xe,4,4,"th",21),l(5,"th",22),w(6,"ACTIONS"),r()()),t&2){let e=s.$implicit;c(4),a("ngForOf",e)}}function ze(t,s){if(t&1&&(l(0,"span"),w(1),r()),t&2){let e=p().$implicit,i=p().$implicit;c(),j(i[e.field])}}function Ze(t,s){t&1&&(l(0,"td",32),h(1,ze,2,1,"span",33),r()),t&2&&a("ngSwitch",!0)}function et(t,s){if(t&1){let e=b();l(0,"tr")(1,"td"),C(2,"button",28),r(),h(3,Ze,2,1,"td",29),l(4,"td")(5,"button",30),_("click",function(){let n=u(e).$implicit,o=p();return f(o.editClient(n))}),r()(),l(6,"td")(7,"button",31),_("click",function(){let n=u(e).$implicit,o=p();return f(o.showDetailClient(n))}),r()()()}if(t&2){let e=s.$implicit,i=s.columns,n=s.expanded;c(2),a("pRowToggler",e)("icon",n?"pi pi-chevron-down":"pi pi-chevron-right"),c(),a("ngForOf",i)}}function tt(t,s){if(t&1&&(l(0,"div",34),w(1),r()),t&2){p();let e=D(8);c(),$(" Au total : ",e.filteredValue?e.filteredValue.length:0," client(s). ")}}var Qt=(()=>{class t{constructor(e,i,n,o,F,g){this.router=e,this.store=i,this.clientService=n,this.opService=o,this.appService=F,this.messageService=g,this.cols=[],this.submitted=!1,this.titleHeader="New Client",this.clientDialog=!1,this.clients=[],this.client={},this.opsWithFilters=[],this.op={},this.ops=[],this.isPersonne=!1,this.isSociete=!1,this.typeSocietes=[],this.disableAdd=!1,this.loading=!1}ngBeforeViewInit(){this.client={id:0,name:"",sigle:"",email:"",telephone:"",adresse:"",latitude:0,longitude:0,prenomContact:"",nomContact:"",emailContact:"",telephoneContact:"",isActive:!0,formeJuridiqueId:0,localiteId:0,pointId:0}}ngOnInit(){this.cols=[{field:"id",header:"ID",sort:!1,filter:!1},{field:"formeJuridiqueName",header:"F.J",sort:!0,filter:!0},{field:"name",header:"ORGANISATION PAYSANNE",sort:!0,filter:!0},{field:"compte",header:"COMPTE",sort:!0,filter:!0},{field:"ninea",header:"NINEA",sort:!0,filter:!0},{field:"numRegistre",header:"REGISTRE",sort:!0,filter:!0},{field:"localiteName",header:"LOCALITE",sort:!0,filter:!0}],this.initDispatch(),this.viderClient()}onCreateClient(e){this.store.dispatch(E({client:e}))}onUpdateClient(e){this.store.dispatch(O({client:e}))}onDeleteClient(e){this.store.dispatch(k({client:e}))}onGetClient(e,i){return i.find(o=>o.id===e)}initDispatch(){let e={opId:null,societeOpId:null,societeAgenceOpId:null,agenceOpId:null,pointId:null,formeJuridiqueId:null,localiteId:null,page:1,limit:10};e.societeOpId=this.appService.getLocalselectedSocieteId(),e.societeAgenceOpId=this.appService.getLocalselectedSocieteId(),e.agenceOpId=this.appService.getLocalselectedAgenceId(),console.log("myFilter before: ",e),this.appService.removeNullProperties(e),console.log("myFilter after: ",e),this.store.dispatch(ie({filter:y({},e)})),this.opsWithFilters$=this.store.pipe(v(oe))}initSubscriptions(){this.clients$=this.store.pipe(v(Fe)),this.isLoading$=this.store.pipe(v(Re)),this.ops$=this.store.pipe(v(ne)),this.isLoadingOps$=this.store.pipe(v(le)),this.typeSocietes$=this.store.pipe(v(re)),this.opsWithFiltersSubscription=this.opsWithFilters$.subscribe(e=>{e&&(this.opsWithFilters=e.map(i=>P(y({},i),{compte:i.SocieteOp?.[0]?.compte,numRegistre:i.SocieteOp?.[0]?.numRegistre,ninea:i.SocieteOp?.[0]?.ninea})))}),this.ops$.subscribe(e=>{this.ops=e,this.ops=e.map(i=>y({},i))}),this.typeSocietes$.subscribe(e=>{this.typeSocietes=e.map(i=>y({},i))})}hideDialog(){this.clientDialog=!1,this.submitted=!1}openNew(){this.submitted=!1,this.titleHeader="New Client",this.clientDialog=!0,this.viderClient()}editClient(e){this.client=y({},e),console.log(" this.client    --- ",e),this.titleHeader="Update Client",this.clientDialog=!0}saveClient(){this.submitted=!0,console.log(" this.client    --- ",this.client),this.client.id?(console.log("Update this.client --- ",this.client),this.store.dispatch(O({client:this.client})),this.viderClient(),this.messageService.add({severity:"success",summary:"Successful",detail:"Client Updated",life:3e3})):(console.log("Add this.client --- ",this.client),this.store.dispatch(E({client:this.client})),this.viderClient(),this.messageService.add({severity:"success",summary:"Successful",detail:"Client Created",life:3e3})),this.clients=[...this.clients],this.clientDialog=!1}isMoment(e){return(0,L.default)(e).format("DD/MM/YYYY")}isMomentAutre(e){return(0,L.default)(e).format("YYYY-MM-DD")}viderClient(){this.client={id:0,name:"",sigle:"",email:"",telephone:"",adresse:"",latitude:0,longitude:0,prenomContact:"",nomContact:"",emailContact:"",telephoneContact:"",isActive:!0,formeJuridiqueId:0,localiteId:0,pointId:0},this.chargerClient()}chargerClient(){this.initSubscriptions()}clear(e){e.clear()}detailClient(e){console.log(`Detail client with ID ${e}`)}onClicked(e){let i=e.target;console.log(i.value)}getValue(e){return console.log(e.target.value),e.target.value}onFilter(e,i){i.filteredValues=e.filteredValue}tableauPointServicesXLSX(){console.log("tableauPointServicesXLSX")}onRowExpandRetourne(e){console.log("event   --- ",e.data),console.log("event.data --- ",e.data.id),console.log("event.data --- ",e.data.name)}onRowExpandRetournePersonne(e){console.log("event   --- ",e.data),console.log("event.data --- ",e.data.id),console.log("event.data --- ",e.data.name),e.data.typeClient.name}onChangeTypeClient(e){console.log(e.value),console.log("event_id :"+e.value.id)}onClearTypeClient(){this.isPersonne=!1,this.isSociete=!1}getTypeSociete(e){return e.name}showDetailClient(e){if(!e){this.messageService.add({severity:"error"});return}this.router.navigate(["/credit"])}static{this.\u0275fac=function(i){return new(i||t)(S(ge),S(ee),S(N),S(N),S(Ee),S(K))}}static{this.\u0275cmp=B({type:t,selectors:[["app-client"]],viewQuery:function(i,n){if(i&1&&(R(ke,5),R(Le,5)),i&2){let o;V(o=M())&&(n.dt=o.first),V(o=M())&&(n.mapElement=o.first)}},standalone:!0,features:[G],decls:16,vars:25,consts:[["mapElement",""],["myTabClients",""],["id","mapElement"],[1,"card"],["styleClass","p-mb-4"],["pTemplate","left"],["pTemplate","right"],["dataKey","id","sortMode","single","rowExpandMode","single","scrollHeight","400px","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"onRowExpand","columns","value","rows","paginator","rowHover","showCurrentPageReport","rowsPerPageOptions","scrollable"],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","summary"],["styleClass","p-fluid",3,"visibleChange","visible","contentStyle","breakpoints","header","modal"],["type","button","pButton","","pRipple","","label","Ajout","icon","pi pi-plus","title","Add new item",1,"p-button-success","p-mr-2",3,"click","disabled"],["type","button","pButton","","pRipple","","label","Export","icon","pi pi-upload","title","Export data",1,"p-button-help",3,"click"],[1,"flex"],["type","button","pButton","","label","Clear","icon","pi pi-filter-slash","title","Clear filters",1,"p-button-outlined",3,"click"],[1,"p-input-icon-left","ml-auto"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search keyword",3,"input"],[2,"width","3rem"],[3,"pSortableColumn",4,"ngFor","ngForOf"],["colspan","2"],[3,"pSortableColumn"],["type","text","display","menu","class","ml-auto",3,"field",4,"ngIf"],[3,"field",4,"ngIf"],["type","text","display","menu",1,"ml-auto",3,"field"],[3,"field"],["type","button","pButton","","pRipple","","text","","rounded","","plain","","aria-label","Toggle row",1,"mr-2",3,"pRowToggler","icon"],[3,"ngSwitch",4,"ngFor","ngForOf"],["type","button","pButton","","pRipple","","icon","pi pi-eye","title","Edit Client",1,"p-button-rounded","p-button-info","p-mr-2",3,"click"],["pButton","","pRipple","","icon","pi pi-chevron-down ","title","Show Details",1,"p-button-rounded","p-button-info","p-mr-2",3,"click"],[3,"ngSwitch"],[4,"ngSwitchDefault"],[1,"p-d-flex","p-ai-center","p-jc-between"]],template:function(i,n){if(i&1){let o=b();C(0,"p-toast")(1,"div",2,0),l(3,"div",3)(4,"p-toolbar",4),h(5,qe,1,1,"ng-template",5)(6,Ge,1,0,"ng-template",6),r(),l(7,"p-table",7,1),_("onRowExpand",function(g){return u(o),f(n.onRowExpandRetourne(g))}),h(9,Qe,6,0,"ng-template",8),C(10,"br"),h(11,Ke,7,1,"ng-template",9)(12,et,8,3,"ng-template",10)(13,tt,2,1,"ng-template",11),r()(),l(14,"p-dialog",12),q("visibleChange",function(g){return u(o),H(n.clientDialog,g)||(n.clientDialog=g),f(g)}),r(),C(15,"p-confirmDialog")}i&2&&(I(x(19,Pe)),c(7),a("columns",n.cols)("value",n.opsWithFilters)("rows",5)("paginator",!0)("rowHover",!0)("showCurrentPageReport",!0)("rowsPerPageOptions",x(20,Be))("scrollable",!0),c(7),I(x(21,We)),W("header",n.titleHeader),Y("visible",n.clientDialog),a("contentStyle",x(22,je))("breakpoints",x(23,Ye))("modal",!0),c(),I(x(24,He)))},dependencies:[De,Ie,z,Te,be,Z,ae,se,_e,de,ue,he,fe,Ce,me,ce,Q,J,U,X,ye,ve,pe,xe,we,Se]})}}return t})();export{Qt as ClientComponent};
