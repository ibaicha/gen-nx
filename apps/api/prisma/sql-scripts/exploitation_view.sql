USE nest_db;
CREATE OR REPLACE VIEW exploitations_view AS
SELECT
	e.id as id,
	e.compte as compte,
	e.date as date,
    e.unite as unite,
	e.surface as surface,
    ag.id as agenceId,
    ag.name as agenceName,
    ag.sigle as agenceSigle,
    so.id as societeId,
    so.name as societeName,
    so.sigle as societeSigle,
    so.email as societeEmail,
    so.adresse as societeAdresse,
    so.telephone as societeTelephone,
    an.id as anneeId,
    an.name as anneeName,
    sa.id as saisonId,
    sa.name as saisonName,
    va.id as varieteId,
    va.name as varieteName,
    prd.id as produitId,
    prd.name as produitName,
	fi.id as filiereId,
    fi.name as filiereName,
    fa.id as familleId,
    fa.name as familleName,
    op.id as opId,
    op.name as opName,
	top.id as typeOpId,
    top.name as typeOpName,
    poi.id as pointId,
    poi.name as pointName,
    pag.id as pointAgenceId,
    pag.name as pointAgenceName,
    pag.sigle as pointAgenceSigle,
    pagso.id as pointAgenceSocieteId,
    pagso.name as pointAgenceSocieteName,
    pagso.name as pointAgenceSocieteSigle
    
    
FROM
	Exploitation e
LEFT JOIN
	Agence ag ON ag.id = e.agenceId
    LEFT JOIN
		Societe so ON so.id = ag.societeId
LEFT JOIN
	Annee an ON an.id = e.anneeId
LEFT JOIN
	Saison sa ON sa.id = e.saisonId
LEFT JOIN
	Variete va ON va.id = e.varieteId
    LEFT JOIN
		Produit prd ON prd.id = va.produitId
        LEFT JOIN
			Filiere fi ON fi.id = prd.filiereId
		LEFT JOIN
			FamilleEmplacement fa ON fa.id = prd.familleEmplacementId
LEFT JOIN
	Op op ON op.id = e.opId
    LEFT JOIN
		TypeOp top ON top.id = op.typeOpId
    LEFT JOIN
		Point poi ON poi.id = op.pointId
		LEFT JOIN
			PointAgence poia ON poia.pointId = poi.id
        LEFT JOIN
			Agence pag ON pag.id = poia.agenceId
            LEFT JOIN
				Societe pagso ON pagso.id = pag.societeId
LEFT JOIN
	Producteur prt ON prt.id = e.producteurId
